"use strict";$(function(){var t=JSON.parse(localStorage.getItem("user"));function n(){$.ajax({url:"http://139.9.177.51:3333/p2p/getuserinfo",type:"get",data:{userid:t.id},success:function(e){var a=e.code,t=e.msg;if(200===a){var n,i=e.data,l=["nickname","email","username","lastlogintime","totalmoney","usablemoney","blockedmoney"];for(n in i)l.includes(n)&&$("#"+n).text(i[n])}else 500===a&&alert(t)}})}n(),$("#editModal").on("shown.bs.modal",function(e){$("#edit-nickname").val($("#nickname").text()),$("#edit-email").val($("#email").text())}),$("#confirm-edit").on("click",function(){$.ajax({url:"http://139.9.177.51:3333/p2p/updateuser",type:"post",data:{userid:t.id,nickname:$("#edit-nickname").val(),email:$("#edit-email").val()},success:function(e){var a=e.code,e=e.msg;200===a?(alert("修改成功"),$("#editModal").modal("hide"),n(),t.nickname=$("#edit-nickname").val(),localStorage.setItem("user",JSON.stringify(t)),$("#loginnav").html('<a class="nav-link" href="#personal">'+t.nickname+"</a>")):500===a&&alert(e)}})})});